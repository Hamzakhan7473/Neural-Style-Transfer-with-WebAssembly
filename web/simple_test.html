<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple WASM Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        button { padding: 10px 20px; margin: 10px; }
        #log { background: #f0f0f0; padding: 15px; margin: 20px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Simple WASM Test</h1>
    
    <button id="loadBtn">Load WASM Module</button>
    <button id="testBtn" disabled>Test Basic Functions</button>
    
    <div id="status"></div>
    <div id="log"></div>

    <script type="module">
        import init, { StyleTransfer } from './pkg/neural_style_transfer.js';
        
        let styleTransfer = null;
        const log = document.getElementById('log');
        const status = document.getElementById('status');
        
        function addLog(message) {
            log.textContent += message + '\n';
            console.log(message);
        }
        
        document.getElementById('loadBtn').addEventListener('click', async () => {
            try {
                addLog('ğŸš€ Loading WASM module...');
                await init();
                addLog('âœ… WASM module loaded successfully');
                
                addLog('ğŸ¨ Creating StyleTransfer instance...');
                styleTransfer = new StyleTransfer('test');
                addLog('âœ… StyleTransfer instance created');
                
                status.innerHTML = '<span class="success">âœ… Module loaded!</span>';
                document.getElementById('testBtn').disabled = false;
                
            } catch (error) {
                addLog(`âŒ Error: ${error.message}`);
                status.innerHTML = `<span class="error">âŒ Failed: ${error.message}</span>`;
            }
        });
        
        document.getElementById('testBtn').addEventListener('click', async () => {
            try {
                addLog('ğŸ§ª Testing basic functions...');
                
                // Test WebGPU initialization
                addLog('ğŸ”§ Testing WebGPU...');
                await styleTransfer.initialize_webgpu();
                addLog('âœ… WebGPU initialized');
                
                // Test style strength
                addLog('ğŸ›ï¸ Testing style strength...');
                styleTransfer.set_style_strength(0.8);
                addLog('âœ… Style strength set');
                
                status.innerHTML = '<span class="success">âœ… All tests passed!</span>';
                
            } catch (error) {
                addLog(`âŒ Test failed: ${error.message}`);
                status.innerHTML = `<span class="error">âŒ Test failed: ${error.message}</span>`;
            }
        });
        
        addLog('ğŸ§ª Simple test page loaded');
        addLog('ğŸ’¡ Click "Load WASM Module" to begin');
    </script>
</body>
</html>
